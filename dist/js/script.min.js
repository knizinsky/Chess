"use strict";var gameBoard=document.getElementById("gameBoard"),ctx=gameBoard.getContext("2d"),brownColor="#653c10",whiteColor="#dfc795",windowWidth=window.innerWidth,windowHeight=window.innerHeight,gameBoardSize=Math.min(windowWidth,windowHeight,600),board=[["r","p","","","","","P","R"],["n","p","","","","","P","N"],["b","p","","","","","P","B"],["q","p","","","","","P","Q"],["k","p","","","","","P","K"],["b","p","","","","","P","B"],["n","p","","","","","P","N"],["r","p","","","","","P","R"]],pieceNames={p:"Bpawn",r:"Brook",n:"Bknight",b:"Bbishop",q:"Bqueen",k:"Bking",P:"Wpawn",R:"Wrook",N:"Wknight",B:"Wbishop",Q:"Wqueen",K:"Wking"},tileSize=gameBoardSize/8,selectedPiece=null,whitesMove=!0,drawPiece=function(e,o,i){var n=new Image;n.src="./dist/img/".concat(e,".png"),n.onload=function(){ctx.drawImage(n,o,i,tileSize,tileSize)}},drawBoardAndPieces=function(e){for(var o=0,i=0;o<e;o+=tileSize,i++)for(var n=0,a=0;n<e;n+=tileSize,a++){ctx.fillStyle=i%2==0?a%2==0?whiteColor:brownColor:a%2==0?brownColor:whiteColor;var t=board[i][a];""!=t&&drawPiece(pieceNames[t],o,n),ctx.fillRect(o,n,tileSize,tileSize)}},resizeCanvas=function(){gameBoard.width=gameBoardSize,gameBoard.height=gameBoardSize,drawBoardAndPieces(gameBoardSize)},selectPiece=function(e){var o=e.offsetX,e=e.offsetY,i=Math.floor(e/tileSize),n=Math.floor(o/tileSize),e=Math.floor(e/tileSize),o=Math.floor(o/tileSize);selectedPiece=board[n][i],movePiece(selectedPiece,e,o)},movePiece=function(e,a,t){var r;if(whitesMove)for(var o in{P:"Wpawn",R:"Wrook",N:"Wknight",B:"Wbishop",Q:"Wqueen",K:"Wking"})o==e&&!function(i){e==i&&board.forEach(function(e,o){e.forEach(function(n,e){n==i&&a==e&&t==o&&(board[t][a]="",console.log(board[t][a]),gameBoard.addEventListener("click",function e(o){drawBoardAndPieces(gameBoardSize);var i=o.offsetX,o=o.offsetY,o=Math.floor(o/tileSize),i=Math.floor(i/tileSize);board[t][a]="",console.log(board),""==board[i][o]&&(board[i][o]=n,r=board[i][o],drawPiece(pieceNames[r],i*tileSize,o*tileSize)),gameBoard.removeEventListener("click",e)}))})})}(o);else for(var i in{p:"Bpawn",r:"Brook",n:"Bknight",b:"Bbishop",q:"Bqueen",k:"Bking"})i==e&&console.log("yolo2")},whosMove=function(){},whiteMoves=function(){},blackMoves=function(){};window.addEventListener("resize",resizeCanvas),window.addEventListener("load",function(){gameBoard.addEventListener("click",selectPiece),resizeCanvas()});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcmlwdC5qcyJdLCJuYW1lcyI6WyJnYW1lQm9hcmQiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiY3R4IiwiZ2V0Q29udGV4dCIsImJyb3duQ29sb3IiLCJ3aW5kb3ciLCJpbm5lcldpZHRoIiwid2hpdGVDb2xvciIsImlubmVySGVpZ2h0Iiwid2luZG93V2lkdGgiLCJ3aW5kb3dIZWlnaHQiLCJnYW1lQm9hcmRTaXplIiwiTWF0aCIsImJvYXJkIiwicGllY2VOYW1lcyIsInAiLCJyIiwibiIsImIiLCJxIiwiayIsInRpbGVTaXplIiwiUCIsIndoaXRlc01vdmUiLCJSIiwiZHJhd1BpZWNlIiwiTiIsIkIiLCJpbWciLCJRIiwiSyIsImRyYXdCb2FyZEFuZFBpZWNlcyIsInNlbGVjdGVkUGllY2UiLCJwaWVjZU5hbWUiLCJ4IiwieSIsImZpbGxTdHlsZSIsInNyYyIsImNvbmNhdCIsIm9ubG9hZCIsImRyYXdJbWFnZSIsImkiLCJqIiwibCIsInBpZWNlIiwib2Zmc2V0WCIsImNsaWNrZWRSb3ciLCJjbGlja2VkQ29sIiwiZmxvb3IiLCJtb3ZlUGllY2UiLCJtb3ZlZFBpZWNlIiwid2hpdGVQaWVjZXNJRCIsInNlbGVjdFBpZWNlIiwiZXZlbnQiLCJvZmZzZXRZIiwiYmxhY2tQaWVjZXNJRCIsIkNSIiwiQ0MiLCJ3aGljaFBpZWNlIiwicGllY2VJRCIsImZvckVhY2giLCJjb25zb2xlIiwibG9nIiwiYWRkRXZlbnRMaXN0ZW5lciIsIm1ha2VNb3ZlIiwiY2xpY2tlZENvbDIiLCJ3aG9zTW92ZSIsImNsaWNrZWRSb3cyIiwicmVzaXplQ2FudmFzIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsIndoaXRlTW92ZXMiLCJibGFja01vdmVzIl0sIm1hcHBpbmdzIjoiYUFBQSxJQUFNQSxVQUFZQyxTQUFTQyxlQUFlLFdBQVcsRUFDL0NDLElBQU1ILFVBQVVJLFdBQVcsSUFBSSxFQUQvQkosV0FBWUMsVUFDWkUsV0FBZSxVQUNmRSxZQUFhQyxPQUFTQyxXQUN0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dC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBnYW1lQm9hcmQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImdhbWVCb2FyZFwiKTtcclxuY29uc3QgY3R4ID0gZ2FtZUJvYXJkLmdldENvbnRleHQoXCIyZFwiKTtcclxuY29uc3QgYnJvd25Db2xvciA9IFwiIzY1M2MxMFwiO1xyXG5jb25zdCB3aGl0ZUNvbG9yID0gXCIjZGZjNzk1XCI7XHJcbmNvbnN0IHdpbmRvd1dpZHRoID0gd2luZG93LmlubmVyV2lkdGg7XHJcbmNvbnN0IHdpbmRvd0hlaWdodCA9IHdpbmRvdy5pbm5lckhlaWdodDtcclxuY29uc3QgZ2FtZUJvYXJkU2l6ZSA9IE1hdGgubWluKHdpbmRvd1dpZHRoLCB3aW5kb3dIZWlnaHQsIDYwMCk7XHJcbmNvbnN0IGJvYXJkID0gW1xyXG5cdFtcInJcIiwgXCJwXCIsIFwiXCIsIFwiXCIsIFwiXCIsIFwiXCIsIFwiUFwiLCBcIlJcIl0sXHJcblx0W1wiblwiLCBcInBcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJQXCIsIFwiTlwiXSxcclxuXHRbXCJiXCIsIFwicFwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlBcIiwgXCJCXCJdLFxyXG5cdFtcInFcIiwgXCJwXCIsIFwiXCIsIFwiXCIsIFwiXCIsIFwiXCIsIFwiUFwiLCBcIlFcIl0sXHJcblx0W1wia1wiLCBcInBcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJQXCIsIFwiS1wiXSxcclxuXHRbXCJiXCIsIFwicFwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlBcIiwgXCJCXCJdLFxyXG5cdFtcIm5cIiwgXCJwXCIsIFwiXCIsIFwiXCIsIFwiXCIsIFwiXCIsIFwiUFwiLCBcIk5cIl0sXHJcblx0W1wiclwiLCBcInBcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJQXCIsIFwiUlwiXSxcclxuXTtcclxuXHJcbmNvbnN0IHBpZWNlTmFtZXMgPSB7XHJcblx0cDogXCJCcGF3blwiLFxyXG5cdHI6IFwiQnJvb2tcIixcclxuXHRuOiBcIkJrbmlnaHRcIixcclxuXHRiOiBcIkJiaXNob3BcIixcclxuXHRxOiBcIkJxdWVlblwiLFxyXG5cdGs6IFwiQmtpbmdcIixcclxuXHJcblx0UDogXCJXcGF3blwiLFxyXG5cdFI6IFwiV3Jvb2tcIixcclxuXHROOiBcIldrbmlnaHRcIixcclxuXHRCOiBcIldiaXNob3BcIixcclxuXHRROiBcIldxdWVlblwiLFxyXG5cdEs6IFwiV2tpbmdcIixcclxufTtcclxuXHJcbmxldCB0aWxlU2l6ZSA9IGdhbWVCb2FyZFNpemUgLyA4O1xyXG5sZXQgc2VsZWN0ZWRQaWVjZSA9IG51bGw7XHJcbmxldCB3aGl0ZXNNb3ZlID0gdHJ1ZTtcclxuXHJcbmNvbnN0IGRyYXdQaWVjZSA9IChwaWVjZU5hbWUsIHgsIHkpID0+IHtcclxuXHRjb25zdCBpbWcgPSBuZXcgSW1hZ2UoKTtcclxuXHRpbWcuc3JjID0gYC4vZGlzdC9pbWcvJHtwaWVjZU5hbWV9LnBuZ2A7XHJcblxyXG5cdGltZy5vbmxvYWQgPSAoKSA9PiB7XHJcblx0XHRjdHguZHJhd0ltYWdlKGltZywgeCwgeSwgdGlsZVNpemUsIHRpbGVTaXplKTtcclxuXHR9O1xyXG59O1xyXG5cclxuY29uc3QgZHJhd0JvYXJkQW5kUGllY2VzID0gKGdhbWVCb2FyZFNpemUpID0+IHtcclxuXHRmb3IgKGxldCBpID0gMCwgaiA9IDA7IGkgPCBnYW1lQm9hcmRTaXplOyBpICs9IHRpbGVTaXplLCBqKyspIHtcclxuXHRcdGZvciAobGV0IGsgPSAwLCBsID0gMDsgayA8IGdhbWVCb2FyZFNpemU7IGsgKz0gdGlsZVNpemUsIGwrKykge1xyXG5cdFx0XHRpZiAoaiAlIDIgPT09IDApIHtcclxuXHRcdFx0XHRpZiAobCAlIDIgPT09IDApIHtcclxuXHRcdFx0XHRcdGN0eC5maWxsU3R5bGUgPSB3aGl0ZUNvbG9yO1xyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRjdHguZmlsbFN0eWxlID0gYnJvd25Db2xvcjtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0aWYgKGwgJSAyID09PSAwKSB7XHJcblx0XHRcdFx0XHRjdHguZmlsbFN0eWxlID0gYnJvd25Db2xvcjtcclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0Y3R4LmZpbGxTdHlsZSA9IHdoaXRlQ29sb3I7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRjb25zdCBwaWVjZSA9IGJvYXJkW2pdW2xdO1xyXG5cclxuXHRcdFx0aWYgKHBpZWNlICE9IFwiXCIpIHtcclxuXHRcdFx0XHRkcmF3UGllY2UocGllY2VOYW1lc1twaWVjZV0sIGksIGspO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRjdHguZmlsbFJlY3QoaSwgaywgdGlsZVNpemUsIHRpbGVTaXplKTtcclxuXHRcdH1cclxuXHR9XHJcbn07XHJcblxyXG5jb25zdCByZXNpemVDYW52YXMgPSAoKSA9PiB7XHJcblx0Z2FtZUJvYXJkLndpZHRoID0gZ2FtZUJvYXJkU2l6ZTtcclxuXHRnYW1lQm9hcmQuaGVpZ2h0ID0gZ2FtZUJvYXJkU2l6ZTtcclxuXHRkcmF3Qm9hcmRBbmRQaWVjZXMoZ2FtZUJvYXJkU2l6ZSk7XHJcbn07XHJcblxyXG5jb25zdCBzZWxlY3RQaWVjZSA9IChldmVudCkgPT4ge1xyXG5cdGxldCB4ID0gZXZlbnQub2Zmc2V0WDtcclxuXHRsZXQgeSA9IGV2ZW50Lm9mZnNldFk7XHJcblxyXG5cdGNvbnN0IGNsaWNrZWRSb3cgPSBNYXRoLmZsb29yKHkgLyB0aWxlU2l6ZSk7XHJcblx0Y29uc3QgY2xpY2tlZENvbCA9IE1hdGguZmxvb3IoeCAvIHRpbGVTaXplKTtcclxuXHJcblx0Y29uc3QgQ1IgPSBNYXRoLmZsb29yKHkgLyB0aWxlU2l6ZSk7XHJcblx0Y29uc3QgQ0MgPSBNYXRoLmZsb29yKHggLyB0aWxlU2l6ZSk7XHJcblxyXG5cdHNlbGVjdGVkUGllY2UgPSBib2FyZFtjbGlja2VkQ29sXVtjbGlja2VkUm93XTtcclxuXHJcblx0bW92ZVBpZWNlKHNlbGVjdGVkUGllY2UsIENSLCBDQyk7XHJcblx0Ly8gY29uc29sZS5sb2coQ0MsIENSLCBcInlvbG9cIik7XHJcbn07XHJcblxyXG5jb25zdCBtb3ZlUGllY2UgPSAoc2VsZWN0ZWRQaWVjZSwgQ1IsIENDKSA9PiB7XHJcblx0bGV0IG1vdmVkUGllY2U7XHJcblx0Y29uc3Qgd2hpdGVQaWVjZXNJRCA9IHtcclxuXHRcdFA6IFwiV3Bhd25cIixcclxuXHRcdFI6IFwiV3Jvb2tcIixcclxuXHRcdE46IFwiV2tuaWdodFwiLFxyXG5cdFx0QjogXCJXYmlzaG9wXCIsXHJcblx0XHRROiBcIldxdWVlblwiLFxyXG5cdFx0SzogXCJXa2luZ1wiLFxyXG5cdH07XHJcblxyXG5cdGNvbnN0IGJsYWNrUGllY2VzSUQgPSB7XHJcblx0XHRwOiBcIkJwYXduXCIsXHJcblx0XHRyOiBcIkJyb29rXCIsXHJcblx0XHRuOiBcIkJrbmlnaHRcIixcclxuXHRcdGI6IFwiQmJpc2hvcFwiLFxyXG5cdFx0cTogXCJCcXVlZW5cIixcclxuXHRcdGs6IFwiQmtpbmdcIixcclxuXHR9O1xyXG5cclxuXHRcclxuXHJcblxyXG5cdGNvbnN0IHdoaWNoUGllY2UgPSAocGllY2VJRCkgPT4ge1xyXG5cdFx0aWYgKHNlbGVjdGVkUGllY2UgPT0gcGllY2VJRCkge1xyXG5cdFx0XHRib2FyZC5mb3JFYWNoKChjbGlja2VkUm93LCBpKSA9PiB7XHJcblx0XHRcdFx0Y2xpY2tlZFJvdy5mb3JFYWNoKChjbGlja2VkQ29sLCBqKSA9PiB7XHJcblx0XHRcdFx0XHRpZiAoY2xpY2tlZENvbCA9PSBwaWVjZUlEICYmIENSID09IGogJiYgQ0MgPT0gaSkge1xyXG5cdFx0XHRcdFx0XHRib2FyZFtDQ11bQ1JdID0gXCJcIjtcclxuXHRcdFx0XHRcdFx0Y29uc29sZS5sb2coYm9hcmRbQ0NdW0NSXSk7XHJcblxyXG5cdFx0XHRcdFx0XHRjb25zdCBtYWtlTW92ZSA9IChldmVudCkgPT4ge1xyXG5cdFx0XHRcdFx0XHRcdGRyYXdCb2FyZEFuZFBpZWNlcyhnYW1lQm9hcmRTaXplKTtcclxuXHRcdFx0XHRcdFx0XHRsZXQgeCA9IGV2ZW50Lm9mZnNldFg7XHJcblx0XHRcdFx0XHRcdFx0bGV0IHkgPSBldmVudC5vZmZzZXRZO1xyXG5cclxuXHRcdFx0XHRcdFx0XHRjb25zdCBjbGlja2VkUm93MiA9IE1hdGguZmxvb3IoeSAvIHRpbGVTaXplKTtcclxuXHRcdFx0XHRcdFx0XHRjb25zdCBjbGlja2VkQ29sMiA9IE1hdGguZmxvb3IoeCAvIHRpbGVTaXplKTtcclxuXHJcblx0XHRcdFx0XHRcdFx0XHJcblx0XHRcdFx0XHRcdFx0XHJcblx0XHRcdFx0XHRcdFx0Ym9hcmRbQ0NdW0NSXSA9IFwiXCI7XHJcblxyXG5cdFx0XHRcdFx0XHRcdGNvbnNvbGUubG9nKGJvYXJkKTtcclxuXHJcblx0XHRcdFx0XHRcdFx0aWYgKGJvYXJkW2NsaWNrZWRDb2wyXVtjbGlja2VkUm93Ml0gPT0gXCJcIikge1xyXG5cdFx0XHRcdFx0XHRcdFx0Ym9hcmRbY2xpY2tlZENvbDJdW2NsaWNrZWRSb3cyXSA9IGNsaWNrZWRDb2w7XHJcblxyXG5cdFx0XHRcdFx0XHRcdFx0bW92ZWRQaWVjZSA9IGJvYXJkW2NsaWNrZWRDb2wyXVtjbGlja2VkUm93Ml07XHJcblxyXG5cdFx0XHRcdFx0XHRcdFx0ZHJhd1BpZWNlKFxyXG5cdFx0XHRcdFx0XHRcdFx0XHRwaWVjZU5hbWVzW21vdmVkUGllY2VdLFxyXG5cdFx0XHRcdFx0XHRcdFx0XHRjbGlja2VkQ29sMiAqIHRpbGVTaXplLFxyXG5cdFx0XHRcdFx0XHRcdFx0XHRjbGlja2VkUm93MiAqIHRpbGVTaXplXHJcblx0XHRcdFx0XHRcdFx0XHQpO1xyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0XHRcdFx0XHJcblxyXG5cdFx0XHRcdFx0XHRcdGdhbWVCb2FyZC5yZW1vdmVFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgbWFrZU1vdmUpO1xyXG5cdFx0XHRcdFx0XHR9O1xyXG5cclxuXHRcdFx0XHRcdFx0Z2FtZUJvYXJkLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBtYWtlTW92ZSk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdH0pO1xyXG5cdFx0fVxyXG5cdH07XHJcblxyXG5cclxuXHRpZiAod2hpdGVzTW92ZSkge1xyXG5cdFx0Ly8gd2hpdGVNb3ZlcyhwaWVjZU5hbWUpXHJcblx0XHRmb3IgKGxldCBwaWVjZUlEIGluIHdoaXRlUGllY2VzSUQpIHtcclxuXHRcdFx0aWYocGllY2VJRCA9PSBzZWxlY3RlZFBpZWNlKXtcclxuXHRcdFx0XHR3aGljaFBpZWNlKHBpZWNlSUQpXHJcblx0XHRcdFx0Ly8gY29uc29sZS5sb2cocGllY2VJRCk7XHJcblx0XHRcdH1cclxuXHRcdCAgfVxyXG5cclxuXHRcdC8vIHdoaXRlc01vdmUgPSBmYWxzZTtcclxuXHR9IGVsc2Uge1xyXG5cdFx0Zm9yIChsZXQgcGllY2VJRCBpbiBibGFja1BpZWNlc0lEKSB7XHJcblx0XHRcdGlmKHBpZWNlSUQgPT0gc2VsZWN0ZWRQaWVjZSl7XHJcblx0XHRcdFx0Ly8gd2hpY2hQaWVjZShwaWVjZUlEKVxyXG5cdFx0XHRcdGNvbnNvbGUubG9nKFwieW9sbzJcIik7XHJcblx0XHRcdH1cclxuXHRcdCAgfVxyXG5cdFx0Ly8gd2hpdGVzTW92ZSA9IHRydWU7XHJcblx0fVxyXG59O1xyXG5cclxuY29uc3Qgd2hvc01vdmUgPSAoKSA9PiB7XHJcblx0aWYgKHdoaXRlc01vdmUpIHtcclxuXHRcdC8vIHdoaXRlTW92ZXMocGllY2VOYW1lKVxyXG5cdFx0Ly8gd2hpdGVzTW92ZSA9IGZhbHNlO1xyXG5cdH0gZWxzZSB7XHJcblx0XHQvLyBibGFja01vdmVzKHBpZWNlTmFtZSlcclxuXHRcdC8vIHdoaXRlc01vdmUgPSB0cnVlO1xyXG5cdH1cclxufTtcclxuXHJcbmNvbnN0IHdoaXRlTW92ZXMgPSAoKSA9PiB7fTtcclxuXHJcbmNvbnN0IGJsYWNrTW92ZXMgPSAoKSA9PiB7fTtcclxuXHJcbndpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwicmVzaXplXCIsIHJlc2l6ZUNhbnZhcyk7XHJcblxyXG53aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcImxvYWRcIiwgKCkgPT4ge1xyXG5cdGdhbWVCb2FyZC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgc2VsZWN0UGllY2UpO1xyXG5cdHJlc2l6ZUNhbnZhcygpO1xyXG59KTtcclxuIl19
